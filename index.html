<!DOCTYPE HTML>
	<html>
	<head>
	<title>Super-Mario</title>
	<meta charset="utf-8">
	<style>
	body {
		margin: 0;
		padding: 0;
		background-color: #000;
	}
	</style>
	<script src = "Menu.js"></script>
        <script src = "Level1.js"></script>
        <script src = "Level2.js"></script>
	<script src="//cdn.jsdelivr.net/phaser/2.6.2/phaser.min.js"></script>
	</head>
	<body>
		<script type="text/javascript">
			var game = new Phaser.Game(380, 240, Phaser.CANVAS, '', this, false, false); /*{
			preload : preload;
			//create : create,
			//update : update
		}, false, false); */
			
			
			
			
			
			
			
	
			function preload() {
				
				//  We need this because the assets are on github pages
				//  Remove the next 2 lines if running locally
				this.load.baseURL = 'https://teogeo.github.io/Super-Mario/';
				this.load.crossOrigin = 'anonymous';
	
			       
		
			}
			
			var score = 0;
			var scoreText;
			var lives=3;
			var counter;
			var music;
			var death;
			var mimage;
			var text1;
			var text2;
			
			 game.state.add('Level1', Level1);
			 game.state.add('Level2', Level2);
		         game.state.add('Menu', Menu);
		         game.state.start('Menu');
		

		function nextlvl(){
			lvl = game.add.audio('housesound');
			
			
			var style = { font: "bold 30px Arial", fill: "#000000", boundsAlignH: "center", boundsAlignV: "middle" };
			text1 = game.add.text(80, 180, "NEXT STAGE", style);
			text1.fixedToCamera = true;
			music.stop();
			player.body.enable = false;
			player.animations.stop();
			game.time.events.add(Phaser.Timer.SECOND * 4, function() {
			game.state.start('Level2');
			});
		}
			
			
			function endgame(){
			
			ends = game.add.audio('housesound');
			var style = { font: "bold 30px Arial", fill: "#000000", boundsAlignH: "center", boundsAlignV: "middle" };
			
			text2 = game.add.text(40, 180, "YOU ARE THE BEST", style);
			
			text2.fixedToCamera=true; 
			music.stop();	
			
			player.body.enable = false;
			player.animations.stop();
			game.time.events.add(Phaser.Timer.SECOND * 6, function() {
			game.stage.backgroundColor = '#000000';	
			
			game.state.start('Menu');
				});
		}

		

			
	
			var coint;
			var stompt;

function pipeOverlap(player,pipe){

	if (cursors.down.isDown && (player.body.onFloor())) {
		player.body.enable=false;
		game.time.events.add(Phaser.Timer.SECOND*0.1 , function() {
					player.body.enable=true;
					player.reset(1415,150);
					});
	}
}

function doorcollide(player, door){
			if (player.body.touching.up){
				door.body.enable = false;
				nextlvl();
			}else if (player.body.touching.right){
				door.body.enable = false;
				nextlvl();
			}else if (player.body.touching.left){
				door.body.enable = false;
				nextlvl();
			}else
				door.body.enable = false;
				nextlvl();
		}
				
				function door1collide(player, door1){
			if (player.body.touching.up){
				door1.body.enable = false;
				endgame();
			}else if (player.body.touching.right){
				door1.body.enable = false;
				endgame();
			}else if (player.body.touching.left){
				
				door1.body.enable = false;
				endgame();
			}else
				door1.body.enable = false;
				endgame();
		}
				
				

	
			function coinOverlap(player, coin) {
				
				coint = game.add.audio('coinsound');
				coint.play();
				coin.kill();
				
				score +=10;
				scoreText.text = 'Score: ' + score;
				
				
			}

			
			function goombaOverlap(player, goomba) {
				
				
				if (player.body.touching.down) {
					stompt = game.add.audio('stompsound');
				        stompt.play();
					
					
					goomba.animations.stop();
					goomba.frame = 2;
					goomba.body.enable = false;
					player.body.velocity.y = -80;
					
					score += 100;
					scoreText.text = 'Score: ' + score;
					
					game.time.events.add(Phaser.Timer.SECOND, function() {
						goomba.kill();
					});
				} else
					
				
				{
					music.stop();
					death = game.add.audio('deathsound');
					death.play();
					
					if(lives>1){
						setTimeout(function(){
							score=0;
							lives-=1;
					game.state.start(game.state.current);
						},2500);
					}else{
						setTimeout(function(){
							alert("Game Over");
							location.reload();
						},1000);}
					player.frame = 6;
					player.body.enable = false;
					player.animations.stop();
					game.time.events.add(Phaser.Timer.SECOND * 3, function() {
						game.paused = true;
					});
					
					
							
				}
			}


			function angryOverlap(player, angry) {
				
				
				if (player.body.touching.down) {
					stompt = game.add.audio('stompsound');
				        stompt.play();
					
					
					angry.animations.stop();
					angry.frame = 2;
					angry.body.enable = false;
					player.body.velocity.y = -80;
					
					score += 100;
					scoreText.text = 'Score: ' + score;
					
					game.time.events.add(Phaser.Timer.SECOND, function() {
						angry.kill();
					});
				} else
					
				
				{
					music.stop();
					death = game.add.audio('deathsound');
					death.play();
					
					if(lives>1){
						setTimeout(function(){
							score=0;
							lives-=1;
					game.state.start(game.state.current);
						},2500);
					}else{
						setTimeout(function(){
							alert("Game Over");
							location.reload();
						},1000);}
					player.frame = 6;
					player.body.enable = false;
					player.animations.stop();
					game.time.events.add(Phaser.Timer.SECOND * 3, function() {
						game.paused = true;
					});
					
					
							
				}
			}
		</script>
	</body>
	</html>
